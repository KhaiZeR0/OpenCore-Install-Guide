(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{544:function(e,t,n){e.exports=n.p+"assets/img/1-boot-efi.e65e5694.png"},545:function(e,t,n){e.exports=n.p+"assets/img/2-kernel-start.3afe7e8a.png"},546:function(e,t,n){e.exports=n.p+"assets/img/5-apfs-module.48a1d1dd.png"},547:function(e,t,n){e.exports=n.p+"assets/img/6-USB-setup.aa24452a.png"},548:function(e,t,n){e.exports=n.p+"assets/img/8-dsmos-arrived.6f362606.png"},549:function(e,t,n){e.exports=n.p+"assets/img/9-audio.9ed667db.png"},550:function(e,t,n){e.exports=n.p+"assets/img/10-GPU.b77ea9f0.png"},551:function(e,t,n){e.exports=n.p+"assets/img/11-boot.d2cee6f9.png"},663:function(e,t,n){"use strict";n.r(t);var o=n(26),r=Object(o.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"hieu-đuoc-qua-trinh-boot-cua-macos"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#hieu-đuoc-qua-trinh-boot-cua-macos"}},[e._v("#")]),e._v(" Hiểu được quá trình boot của macOS")]),e._v(" "),o("p",[e._v("Với việc khắc phục sự cố hackintosh, nó sẽ có một chút khó khăn để hiểu được "),o("em",[e._v("nơi")]),e._v(" mà bạn đang bị mắc kẹt lại khi từng những từ khoá mà bạn đang cố gắng tìm kiếm có thể không trùng với kết quả gì trên google. Tuy trang này sẽ không giúp bạn khắc phục tất cả các sự cố, ít nhất nó sẽ giúp bạn hiểu tốt hơn nơi mà quuas trình boot của macOS mà bạn đang mắc kẹt và hy vọng nó sẽ cho bạn thêm ý tưởng về việc sại sao bạn bị mắc kẹt.")]),e._v(" "),o("h2",{attrs:{id:"qua-trinh-boot-opencore"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#qua-trinh-boot-opencore"}},[e._v("#")]),e._v(" Quá trình boot OpenCore")]),e._v(" "),o("p",[e._v("Phần này sẽ ngắn gọn, vì vấn đề boot của OpenCore thường như hiếm và thường là các lỗi đơn giản:")]),e._v(" "),o("ul",[o("li",[e._v("Hệ thống khởi động lên và tìm kiếm thiết bị boot")]),e._v(" "),o("li",[e._v("Hệ thống xác định BOOTx64.efi trên USB OpenCore của bạn tại EFI/BOOT/")]),e._v(" "),o("li",[e._v("BOOTx64.efi được khởi chạy và sẽ chạy OpenCore.efi từ EFI/OC/")]),e._v(" "),o("li",[e._v("Tính chất của NVRAM được áp dụng")]),e._v(" "),o("li",[e._v("Driver EFI được khởi chạy từ EFI/OC/Drivers")]),e._v(" "),o("li",[e._v("Graphics Output Protocol(GOP) được cài đặt")]),e._v(" "),o("li",[e._v("Bảng ACPI được khởi chạy từ EFI/OC/ACPI")]),e._v(" "),o("li",[e._v("Thông tin SMBIOS được áp dụng")]),e._v(" "),o("li",[e._v("OpenCore chạy và hiển thị cho bạn tất cả thiết bị để boot")]),e._v(" "),o("li",[e._v("Bây giờ bạn có thể khởi chạy bộ cài đặt macOS của bạn")])]),e._v(" "),o("p",[e._v("Nếu bạn gặp quá trình về boot tại thời điểm này, những thứ chính cần kiểm tra:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/opencore-issues.html#stuck-on-no-vault-provided"}},[e._v("Mắc kẹt tại "),o("code",[e._v("no vault provided!")])])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/opencore-issues.html#can-t-see-macos-partitions"}},[e._v("Không thể nhìn thất phân vùng macOS")])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/opencore-issues.html#booting-opencore-reboots-to-bios"}},[e._v("Boot OpenCore khởi động lại về BIOS")])],1)]),e._v(" "),o("p",[e._v("Cho những vấn đề có thể xảy ra còn lại, xem:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/opencore-issues.html"}},[e._v("OpenCore booting issues")])],1)]),e._v(" "),o("h2",{attrs:{id:"handoff-boot-efi"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#handoff-boot-efi"}},[e._v("#")]),e._v(" Handoff boot.efi")]),e._v(" "),o("p",[o("img",{attrs:{src:n(544),alt:""}})]),e._v(" "),o("p",[e._v("This is where macOS's bootloader(boot.efi) comes onto the scene, specifically what it does is prep the environment for the kernel to load and where OpenCore injects kexts. If you're getting stuck at this point, there's likely an issue with loading the kernel, main culprits:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#stuck-on-endrandomseed"}},[e._v("Stuck on EndRandomSeed")])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#stuck-on-eb-log-exitbs-start"}},[e._v("Stuck on "),o("code",[e._v("[EB|#LOG:EXITBS:START]")])])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#couldn-t-allocate-runtime-area-errors"}},[o("code",[e._v("Couldn't allocate runtime area")]),e._v(" errors")])],1)]),e._v(" "),o("p",[e._v("Cho những vấn đề có thể xảy ra còn lại, xem:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html"}},[e._v("Kernel Issues")])],1)]),e._v(" "),o("p",[o("strong",[e._v("Lưu ý")]),e._v(": Trong macOS 10.15.4, Apple đã đổi phương thức sửa lỗi trong boot.efi, cho nên nó sẽ trông khác biệt chút so với trước nhưng chung quy là nó đều theo cùng một quy luật")]),e._v(" "),o("h2",{attrs:{id:"handoff-xnu-kernel"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#handoff-xnu-kernel"}},[e._v("#")]),e._v(" Handoff XNU/Kernel")]),e._v(" "),o("p",[e._v("Now that boot.efi has setup everything for us, we now get to watch the kernel do it's thing. This section is commonly referred as the "),o("a",{attrs:{href:"https://developer.apple.com/library/archive/documentation/Darwin/Conceptual/KernelProgramming/booting/booting.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rooting phase"),o("OutboundLink")],1),e._v(":")]),e._v(" "),o("p",[o("img",{attrs:{src:n(545),alt:""}})]),e._v(" "),o("p",[e._v("This section is where SMBIOS data is verified, ACPI tables/Kexts are loaded and macOS tries to get everything in order. Failures here are generally a result of:")]),e._v(" "),o("ul",[o("li",[e._v("SSDT bị")]),e._v(" "),o("li",[e._v("Corrupted kexts(or incorrectly setup under your config.plist -> Kernel -> Add)")]),e._v(" "),o("li",[e._v("Messed up memory map")])]),e._v(" "),o("p",[e._v("See here for more troubleshooting info:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#kernel-panic-cannot-perform-kext-summary"}},[e._v("Kernel Panic "),o("code",[e._v("Cannot perform kext summary")])])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#kernel-panic-on-invalid-frame-pointer"}},[e._v("Kernel Panic on "),o("code",[e._v("Invalid frame pointer")])])],1)]),e._v(" "),o("p",[o("img",{attrs:{src:n(546),alt:""}})]),e._v(" "),o("p",[e._v("Now here we have "),o("code",[e._v("[ PCI configurations begin ]")]),e._v(", this section can be seen as a hardware test for our systems, kexts and SSDTs we injected, and where IOKit starts hardware probs to find devices to attach to.")]),e._v(" "),o("p",[e._v("The main things that are tested here:")]),e._v(" "),o("ul",[o("li",[e._v("Embedded Controllers")]),e._v(" "),o("li",[e._v("Storage(NVMe, SATA, etc)")]),e._v(" "),o("li",[e._v("PCI/e")]),e._v(" "),o("li",[e._v("NVRAM")]),e._v(" "),o("li",[e._v("RTC")]),e._v(" "),o("li",[e._v("PS2 and I2C")])]),e._v(" "),o("p",[e._v("For more specific info on how to get around this area, see here:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#stuck-on-rtc-pci-configuration-begins-previous-shutdown-hpet-hid-legacy"}},[e._v("Stuck on "),o("code",[e._v("RTC...")]),e._v(", "),o("code",[e._v("PCI Configuration Begins")]),e._v(", "),o("code",[e._v("Previous Shutdown...")]),e._v(", "),o("code",[e._v("HPET")]),e._v(", "),o("code",[e._v("HID: Legacy...")])])],1)]),e._v(" "),o("p",[o("img",{attrs:{src:n(547),alt:""}})]),e._v(" "),o("p",[e._v('This is where the 15 port limit and USB mapping comes into play, and where the infamous "Waiting for Root Device" errors pops in, main things to check for:')]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#waiting-for-root-device-or-prohibited-sign-error"}},[e._v('"Waiting for Root Device" or Prohibited Sign error')])],1)]),e._v(" "),o("p",[o("img",{attrs:{src:n(548),alt:""}})]),e._v(" "),o("p",[e._v("This is where our FakeSMC/VirtualSMC come into the scene and do their magic, DSMOS itself is a kext that verifies if your system has an SMC and will request a key. If this key is missing, then DSMOS will not decrypt the rest of the binaries and you'll get stuck here. You may also get stuck at AppleACPICPU which is just the same error.")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#kextd-stall-0-appleacpicpu"}},[e._v("kextd stall[0]: AppleACPICPU")])],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("Your karma check for today:\nThere once was a user that whined\nhis existing OS was so blind,\nhe'd do better to pirate an OS that ran great\nbut found his hardware declined.\nPlease don't steal Mac OS!\nReally, that's way uncool.\n(C) Apple Computer, Inc.\nTạm dịch:\nKiểm tra công việc của bạn hôm nay cho thấy:\nĐã từng có người dùng than vãn rằng\nhệ điều hành của anh ấy quá chậm chạp\nanh ấy tốt hơn là trộm một hệ điều hành tuyệt vời\nnhưng rồi phát hiện ra phần cứng bị từ chối.\nXin đừng ăn trộm Mac OS!\nThật đó, nó không thoải mái chút nào.\n(C) Apple Computer, Inc.\n")])])]),o("p",[e._v("Nguồn: Dont Steal Mac OS X.kext")]),e._v(" "),o("p",[o("img",{attrs:{src:n(549),alt:""}})]),e._v(" "),o("p",[e._v('Đây là nơi mà driver âm thanh của Apple vào, nơi sẽ làm AppleALC "sáng" lên. Chung là khá hiếm để thấy vấn đề ở đây nhưng nếu bạn gặp phải, thử huỷ kích hoạt AppleALC và những kext khác liên quan đến âm .')]),e._v(" "),o("p",[o("img",{attrs:{src:n(550),alt:""}})]),e._v(" "),o("p",[e._v("And here we get to the GPU driver initialization, and where WhateverGreen also does its magic. Generally errors here are due to the GPU and not WhateverGreen itself, main culprits:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#stuck-on-or-near-ioconsoleusers-gioscreenlock-giolockstate-3"}},[e._v("Stuck on or near "),o("code",[e._v("IOConsoleUsers: gIOScreenLock...")])])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#black-screen-after-ioconsoleusers-gioscreenlock-on-navi"}},[e._v("Black screen after "),o("code",[e._v("IOConsoleUsers: gIOScreenLock...")]),e._v(" on Navi")])],1)]),e._v(" "),o("h2",{attrs:{id:"macos-handoff"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#macos-handoff"}},[e._v("#")]),e._v(" macOS Handoff")]),e._v(" "),o("p",[o("img",{attrs:{src:n(551),alt:""}})]),e._v(" "),o("p",[e._v("And you've finally got past all that verbose! If you're getting stuck at the Apple logo after all that verbose, then there's a couple things to check for:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#macos-frozen-right-before-login"}},[e._v("macOS frozen right before login")])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/kernel-issues.html#black-screen-after-ioconsoleusers-gioscreenlock-on-navi"}},[e._v("Black screen after "),o("code",[e._v("IOConsoleUsers: gIOScreenLock...")]),e._v(" on Navi")])],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/troubleshooting/extended/userspace-issues.html#frozen-in-the-macos-installer-after-30-seconds"}},[e._v("Frozen in the macOS installer after 30 seconds")])],1)])])}),[],!1,null,null,null);t.default=r.exports}}]);